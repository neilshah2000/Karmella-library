(this["webpackJsonp@coreui/coreui-free-react-admin-template"]=this["webpackJsonp@coreui/coreui-free-react-admin-template"]||[]).push([[4],{677:function(e,t,a){e.exports=a.p+"static/media/karmela.41a4104d.png"},686:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(24),c=a(28),o=a(128),m=a(78),u=a(51),i=a(25),s=function(e){var t=Object(m.b)();return l.a.createElement(c.e,{accentColor:"primary"},l.a.createElement(c.i,null,l.a.createElement("h5",null,e.book.title)),l.a.createElement(c.f,null,e.book.author_names),l.a.createElement(c.g,null,l.a.createElement("div",{className:"d-flex justify-content-between"},l.a.createElement("div",null,l.a.createElement("div",null,"Copies: ",e.book.copies.length),l.a.createElement("div",null,"Available: ",e.book.copies.filter((function(e){return"Available"===e.status})).length)),l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement(c.C,{onClick:function(){t(Object(i.n)(e.book))}},"Add to Basket"))))))},E=function(e){var t=e.searchButtonClicked,a=e.onSearchTextChange,n=e.inputText,r=e.onShelfSelected,o=e.selectedShelf,m=e.shelves,i=e.books,E=e.onBookUpdated,b=e.currentPage,d=e.pageCount,h=e.setCurrentPage,f=e.totalResults;return l.a.createElement(c.L,null,l.a.createElement(c.j,null,l.a.createElement("h2",{className:"mb-4"},"Book Search"),l.a.createElement(c.L,null,l.a.createElement(c.j,{sm:"4"},l.a.createElement(c.x,{className:"mb-4"},l.a.createElement(c.z,null,l.a.createElement(c.d,{onClick:t,type:"button",color:"primary"},l.a.createElement(u.a,{name:"cil-magnifying-glass"})," Search")),l.a.createElement(c.w,{placeholder:"Title or abstract",onChange:a,value:n}))),l.a.createElement(c.j,{sm:"4"}),l.a.createElement(c.j,{sm:"4"},l.a.createElement(c.r,{row:!0},l.a.createElement(c.j,{md:"3"},l.a.createElement(c.B,{htmlFor:"shelfSelect",className:"pt-1"},"Shelf")),l.a.createElement(c.j,{xs:"12",md:"9"},l.a.createElement(c.M,{custom:!0,name:"shelfSelect",id:"shelfSelect",onChange:r,value:o},m.map((function(e){return l.a.createElement("option",{value:e.id,key:e.id},e.name)}))))))),l.a.createElement(c.L,null,i.map((function(e){return l.a.createElement(c.j,{xs:"12",sm:"6",md:"4",key:e.id},l.a.createElement(s,{book:e,updated:E}))}))),l.a.createElement(c.J,{activePage:b,pages:d,onActivePageChange:h}),l.a.createElement("span",null,f+" results")))},b=a(64),d=function(e){return e.shelf.all.concat([{id:!1,name:" -- select an option -- "}])},h=function(){var e=Object(n.useState)(1),t=Object(o.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(""),u=Object(o.a)(c,2),s=u[0],h=u[1],f=Object(n.useState)(""),p=Object(o.a)(f,2),g=p[0],k=p[1],v=Object(n.useState)(!1),j=Object(o.a)(v,2),C=j[0],O=j[1],S=Object(n.useState)(20),w=Object(o.a)(S,2),y=w[0],N=(w[1],Object(n.useState)(null)),B=Object(o.a)(N,2),x=(B[0],B[1]),F=Object(m.b)();Object(n.useEffect)((function(){F(Object(b.e)())}),[F]),Object(n.useEffect)((function(){F(Object(i.q)(a,y,s,C))}),[F,a,y,s,C]);var P=Object(m.c)(d),R=Object(m.c)((function(e){return e.books.searchResults.results})),L=Object(m.c)((function(e){return e.books.searchResults.count}));var T={searchButtonClicked:function(){O(!1),h(g)},onSearchTextChange:function(e){k(e.target.value)},inputText:g,onShelfSelected:function(e){k(""),O(parseInt(e.target.value))},selectedShelf:C,shelves:P,books:R,onBookUpdated:function(){console.log("bookupdated"),x(Math.random())},currentPage:a,pageCount:Math.ceil(L/y),setCurrentPage:r,totalResults:L};return l.a.createElement(E,T)},f=a(674),p=a.n(f),g=a(675),k=a(678),v=a(679),j=function(e){var t=e.options,a=e.children,n=e.maxHeight,r=(0,e.getValue)(),c=Object(o.a)(r,1)[0],m=35*t.indexOf(c);return l.a.createElement(v.a,{height:n,itemCount:a.length,itemSize:35,initialScrollOffset:m},(function(e){var t=e.index,n=e.style;return l.a.createElement("div",{style:n},a[t])}))};var C=a(46),O=a.n(C);function S(e){var t="/catalog/api/books/"+e;return O.a.get(t).then((function(e){return e.data}))}function w(){return O.a.get("/catalog/api/authors/").then((function(e){return e.data})).then((function(e){return e.map((function(e){return e.value=e.id,e.key=e.id,e.label=e.first_name+" "+e.last_name,e}))}))}var y=function(e){var t=Object(r.i)(),a=Object(n.useState)({title:"",titleShort:"",isbn:"",callNumber:"",language:"",pages:"",publisher:"",publisherPlace:"",issued:"",collectionTitle:"",place:"",abstract:""}),m=Object(o.a)(a,2),i=m[0],s=m[1],E=Object(n.useState)([]),b=Object(o.a)(E,2),d=b[0],h=b[1],f=Object(n.useState)([]),v=Object(o.a)(f,2),C=v[0],y=v[1];function N(e){var t=e.target.id,a=e.target.value,n=JSON.parse(JSON.stringify(i));n[t]=a,s(n)}return Object(n.useEffect)((function(){!function(){var e=Object(g.a)(p.a.mark((function e(){var a,n,l,r,c,m;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.id){e.next=13;break}return e.next=3,Promise.all([w(),S(t.id)]);case 3:a=e.sent,n=Object(o.a)(a,2),l=n[0],r=n[1],s(r),h(l),c=l.filter((function(e){return r.author.includes(e.id)})),y(c),e.next=17;break;case 13:return e.next=15,w();case 15:m=e.sent,h(m);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[t]),l.a.createElement(l.a.Fragment,null,l.a.createElement(c.L,null,l.a.createElement(c.j,null,l.a.createElement("h2",{className:"mb-4"},"Create Book"),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"title"},"Authors"),l.a.createElement(k.a,{components:{MenuList:j},onChange:function(e){y(e)},value:C,options:d,isMulti:!0})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"title"},"Title"),l.a.createElement(c.w,{id:"title",placeholder:"Book title",onChange:N,value:i.title||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"titleShort"},"Short Title"),l.a.createElement(c.w,{id:"titleShort",placeholder:"Short title",onChange:N,value:i.titleShort||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"isbn"},"ISBN"),l.a.createElement(c.w,{id:"isbn",placeholder:"978-1-86197-876-9",onChange:N,value:i.isbn||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"callNumber"},"Call Number"),l.a.createElement(c.w,{id:"callNumber",placeholder:"",onChange:N,value:i.callNumber||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"language"},"Language"),l.a.createElement(c.w,{id:"language",placeholder:"es",onChange:N,value:i.language||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"pages"},"Pages"),l.a.createElement(c.w,{id:"pages",placeholder:"",onChange:N,value:i.pages||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"publisher"},"Publisher"),l.a.createElement(c.w,{id:"publisher",placeholder:"",onChange:N,value:i.publisher||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"publisherPlace"},"Publisher Place"),l.a.createElement(c.w,{id:"publisherPlace",placeholder:"",onChange:N,value:i.publisherPlace||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"issued"},"Issued"),l.a.createElement(c.w,{id:"issued",placeholder:"",onChange:N,value:i.issued||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"collectionTitle"},"Collection Title"),l.a.createElement(c.w,{id:"collectionTitle",placeholder:"",onChange:N,value:i.collectionTitle||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"place"},"Place"),l.a.createElement(c.w,{id:"place",placeholder:"",onChange:N,value:i.place||""})),l.a.createElement(c.r,null,l.a.createElement(c.B,{htmlFor:"abstract"},"Abstract"),l.a.createElement(c.S,{name:"abstract",id:"abstract",rows:"10",placeholder:"Content...",onChange:N,value:i.abstract||""})))),l.a.createElement(c.L,null,l.a.createElement(c.j,null,l.a.createElement("span",{className:"mr-2"},l.a.createElement(c.d,{type:"submit",size:"sm",color:"primary",onClick:function(){i.author=C.map((function(e){return e.key})),t.id?function(e){var t="/catalog/api/books/"+e.id+"/",a=JSON.stringify(e);return O.a.put(t,a).then((function(e){return e.data}))}(i).then((function(e){console.log(e)})):function(e){var t=JSON.stringify(e);return O.a.post("/catalog/api/books/",t).then((function(e){return e.data}))}(i).then((function(e){console.log(e)}))}},l.a.createElement(u.a,{name:"cil-scrubber"})," Submit")),l.a.createElement(c.d,{type:"reset",size:"sm",color:"danger",onClick:function(){console.log("test")}},l.a.createElement(u.a,{name:"cil-ban"})," Reset"))))},N=function(e){var t=e.book,a=e.onRemove;return l.a.createElement(c.e,{accentColor:"success"},l.a.createElement(c.i,null,l.a.createElement("h5",null,t.title)),l.a.createElement(c.f,null,t.authorNames),l.a.createElement(c.g,null,l.a.createElement(c.C,{onClick:function(){a(t)}},"Remove")))},B=function(e){var t=e.show,a=e.onClose,n=e.books,r=e.onConfirm;return l.a.createElement(c.F,{show:t,onClose:a},l.a.createElement(c.I,{closeButton:!0},"Checkout"),l.a.createElement(c.G,null,n.map((function(e,t){return l.a.createElement(c.D,{key:t},l.a.createElement(c.E,null,l.a.createElement("h5",null,e.title),l.a.createElement("div",null,Date.now())))}))),l.a.createElement(c.H,null,l.a.createElement(c.d,{onClick:r,color:"primary"},"Confirm Checkout"),l.a.createElement(c.d,{color:"secondary",onClick:a},"Cancel")))},x=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),a=t[0],r=t[1],u=Object(m.b)(),s=Object(m.c)((function(e){return e.books.basket})),E=function(e){console.log(e),u(Object(i.r)(e))},b={show:a,onClose:function(){r(!1)},books:s,onConfirm:function(){var e=[];s.forEach((function(t){t.copies.length>0&&e.push(t.copies[0])})),u(Object(i.o)(e))}};return l.a.createElement(c.L,null,l.a.createElement(c.j,null,l.a.createElement("div",{className:"d-flex justify-content-between mb-2"},l.a.createElement("div",{className:"mb-4"},"Basket"),l.a.createElement(c.d,{onClick:function(){return r(!0)},type:"button",color:"primary",disabled:0===s.length},"Checkout")),l.a.createElement(c.L,null,s.map((function(e,t){return l.a.createElement(c.j,{xs:"12",sm:"6",md:"4",key:t},l.a.createElement(N,{book:e,onRemove:E}))}))),0===s.length&&l.a.createElement(c.L,null,"Basket is empty"),l.a.createElement(B,b)))},F=function(e){var t=e.book,a=e.onBookReturned,n=t.book.author.map((function(e){return e.first_name+" "+e.last_name})).join(", ");return l.a.createElement(c.e,{accentColor:"primary"},l.a.createElement(c.i,null,l.a.createElement("h5",null,t.book.title)),l.a.createElement(c.f,null,n),l.a.createElement(c.g,null,l.a.createElement(c.C,{onClick:function(){return a(t)}},"Return")))},P=function(){var e=Object(m.b)();Object(n.useEffect)((function(){e(Object(i.p)())}),[e]);var t=Object(m.c)((function(e){return e.books.borrowed}));console.log(t);var a=function(e){console.log(e)};return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",null,"My Borrowed"),l.a.createElement(c.L,null,t.map((function(e){return l.a.createElement(c.j,{xs:"12",sm:"6",md:"4",key:e.id},l.a.createElement(F,{book:e,onBookReturned:a}))}))))},R={zIndex:9,top:"50%",right:"50%",marginTop:-16,marginRight:-16},L=function(){var e=Object(m.c)((function(e){return e.spinner}));return console.log(e),l.a.createElement(l.a.Fragment,null,e>0&&l.a.createElement("div",{className:"spinner-border text-primary position-fixed d-block",style:R,role:"status"},l.a.createElement("span",{className:"sr-only"},"Loading...")))},T=function(e){var t=Object(m.c)((function(e){return e.toasts.all}));return console.log(t),l.a.createElement(l.a.Fragment,null,l.a.createElement(c.W,{position:"bottom-right"},t.map((function(e,t){return l.a.createElement(c.T,{key:"toast"+t,show:!0,autohide:5e3,fade:!0},l.a.createElement(c.V,null,"Toast title"),l.a.createElement(c.U,null,e.status))}))))},I=a(126),M=function(e){var t=e.component,a=Object(I.a)(e,["component"]);console.log(t);var n=Object(m.c)((function(e){return e.login.loggedIn}));return l.a.createElement(r.b,Object.assign({},a,{render:function(e){return n?l.a.createElement(t,e):l.a.createElement(r.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},J=l.a.createElement("div",{className:"pt-3 text-center"},l.a.createElement("div",{className:"sk-spinner sk-spinner-pulse"})),_=l.a.memo((function(){return l.a.createElement("main",{className:"c-main"},l.a.createElement(c.k,{fluid:!0},l.a.createElement(T,null),l.a.createElement(L,null),l.a.createElement(n.Suspense,{fallback:J},l.a.createElement(r.d,null,l.a.createElement(M,{exact:!0,path:"/bookSearch",name:"Book Search",component:h}),l.a.createElement(M,{exact:!0,path:"/book",name:"Book Create",component:y}),l.a.createElement(M,{exact:!0,path:"/bookEdit/:id",name:"Book Detail",component:y}),l.a.createElement(M,{exact:!0,path:"/basket",name:"Basket",component:x}),l.a.createElement(M,{exact:!0,path:"/myBorrowed",name:"My Borrowed",component:P}),l.a.createElement(r.a,{from:"/",to:"/bookSearch"})))))})),A=l.a.memo((function(){return l.a.createElement(c.p,{fixed:!1},l.a.createElement("div",null,l.a.createElement("a",{href:"https://coreui.io",target:"_blank",rel:"noopener noreferrer"},"CoreUI"),l.a.createElement("span",{className:"ml-1"},"\xa9 2020 creativeLabs.")),l.a.createElement("div",{className:"mfs-auto"},l.a.createElement("span",{className:"mr-1"},"Powered by"),l.a.createElement("a",{href:"https://coreui.io/react",target:"_blank",rel:"noopener noreferrer"},"CoreUI for React")))})),z=function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.sidebarShow})),a=Object(m.c)((function(e){return e.user.me})),n=Object(m.c)((function(e){return e.books.basket.length}));return l.a.createElement(c.s,{withSubheader:!0},l.a.createElement(c.X,{inHeader:!0,className:"ml-md-3 d-lg-none",onClick:function(){var a=!![!1,"responsive"].includes(t)||"responsive";e({type:"set",sidebarShow:a})}}),l.a.createElement(c.X,{inHeader:!0,className:"ml-3 d-md-down-none",onClick:function(){var a=![!0,"responsive"].includes(t)&&"responsive";e({type:"set",sidebarShow:a})}}),l.a.createElement(c.t,{className:"mx-auto d-lg-none",to:"/"},l.a.createElement(u.a,{name:"logo",height:"48",alt:"Logo"})),l.a.createElement(c.u,{className:"d-md-down-none mr-auto"}),a&&a.email&&l.a.createElement(c.u,{className:"mr-5"},a.email),l.a.createElement(c.u,{className:"mr-5"},l.a.createElement(c.C,{to:"/basket"},l.a.createElement(u.a,{name:"cil-basket"}),l.a.createElement(c.a,{shape:"pill",color:"danger"},n))))},U=a(677),H=a.n(U),D=a(394),V=l.a.memo((function(){var e=Object(m.b)(),t=Object(m.c)((function(e){return e.sidebarShow})),a=Object(r.g)();return l.a.createElement(c.N,{show:t,onShowChange:function(t){return e({type:"set",sidebarShow:t})}},l.a.createElement(c.O,{className:"d-md-down-none white",to:"/"},l.a.createElement(c.v,{src:H.a,className:"c-sidebar-brand-full logo",alt:"admin@bootstrapmaster.com"})),l.a.createElement(c.Q,null,l.a.createElement(c.R,{name:"Search",to:"/bookSearch",icon:"cil-search"}),l.a.createElement(c.R,{name:"Basket",to:"/basket",icon:"cil-basket"}),l.a.createElement(c.R,{name:"My Borrowed",to:"/myBorrowed",icon:"cil-book"}),l.a.createElement(c.R,{name:"Logout",onClick:function(){Object(D.b)().then((function(e){console.log(e),a.push("/login")}),(function(e){console.log(e)}))},icon:"cil-account-logout"})),l.a.createElement(c.P,{className:"c-d-md-down-none"}))}));t.default=function(){return l.a.createElement("div",{className:"c-app c-default-layout"},l.a.createElement(V,null),l.a.createElement("div",{className:"c-wrapper"},l.a.createElement(z,null),l.a.createElement("div",{className:"c-body"},l.a.createElement(_,null)),l.a.createElement(A,null)))}}}]);
//# sourceMappingURL=4.f0991486.chunk.js.map